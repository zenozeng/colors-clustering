<!doctype HTML>
<head>
    <meta charset="UTF-8">
    <title>Colors Project</title>
    <style>
     body {
         padding: 4em;
         color: #555;
     }
     #image {
         float: left;
         width: calc(100% - 424px);
         height: 400px;
         margin-right: 20px;
         line-height: 400px;
         text-align: center;
         border: 1px solid #ccc;
         background-position: center center;
         background-size: cover;
     }
     #colors {
         float: left;
         border: 1px solid #ccc;
         width: 400px;
         text-align: center;
         line-height: 400px;
         height: 400px;
     }
     #colors h2 {
         width: 400px;
         text-align: center;
     }
     .color {
         float: left;
         width: 100px;
         height: 100px;
     }
    </style>
</head>
<body>
    <main id="main">
        <div id="image">
            Drag Your Image Here
        </div>
        <div id="colors">
        </div>
    </main>
    <script src="../browser.js"></script>
    <script>
     (function() {
         var box, log;

         display = function(colors) {
             var html;
             html = colors.map(function(color) {
                 var h, l, s;
                 if (color == null) {
                     color = [0, 0, 100];
                 }
                 h = color[0], s = color[1], l = color[2];
                 return "<div class='color' style='background: hsl(" + h + ", " + s + "%, " + l + "%)'></div>";
             });
             html = "<div class='colors'>" + (html.join('')) + "</div>";
             return document.getElementById("colors").innerHTML += html;
         };

         box = document.getElementById("image");

         box.ondragover = function(event) {
             this.className = 'hover';
             return event.preventDefault();
         };

         box.ondragend = function(event) {
             this.className = '';
             return event.preventDefault();
         };

         box.ondrop = function(event) {
             var file, reader;
             box.innerHTML = "";
             document.getElementById("colors").innerHTML = "Calculating...";
             event.preventDefault();
             file = event.dataTransfer.files[0];
             reader = new FileReader;
             reader.onload = function(event) {
                 var dataURL;
                 dataURL = event.target.result;
                 window.colorsClustering({src: dataURL, debug: false}, function(centers) {
                     return display(centers);
                 });
                 return box.style.backgroundImage = "url(" + dataURL + ")";
             };
             reader.readAsDataURL(file);
         };

     }).call(this);
    </script>
</body>
